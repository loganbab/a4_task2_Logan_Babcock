---
title: "Assignment 4 Task 2"
author: "Logan Babcock"
date: "November 4, 2021"
output: html_document
---

```{r setup, include=FALSE, messages = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE,  messages = FALSE, warning = FALSE, fig.align = "center")

library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(lubridate)


hares_raw <- read.csv(here("data", "bonanza_hares.csv"))

```

## 1. Overview
This is an exploratory report on juvenile snoeshoe hares (*Lepus americanus*) using data collected during the  US Long Term Ecological Research Network's study on Snowshoe hare physical data in the Bonanza Creek Experimental Forest. Using the data collected from 1999-2012, this report will analyze the counts and sizes of juvenile hares.

*COME BACK TO FINISH THIS  - add info on what the report contains*

## 2. Data and Methods
Snowshoe hare data and measurements were made accessible through Knut Kielland and associates at the Bonanza Creek LTER. The data contain measurements and observations on hares during a capture-recapture study done in Alaska's Tanana valley from 1999-2012. 

*COME BACK TO FINISH THIS - add info on stats tests and whats included* 

## Data Visualization and Analysis

### Juvenile Hare Survey Counts

```{r, layout="l-body-outset", fig.width = 10}

# finding juvenile hare counts

# making separate year column
hares_year <- hares_raw %>% # making new dataset with new date column
  mutate(date_new = mdy(date)) %>% # new column with date class
  mutate(year = year(date_new)) %>% # new column with just year
  filter(age == "j") # filtering for just juveniles

yearly_count <- hares_year %>% # making a dataset wiht just year and count
  group_by(year) %>% # grouping by year
  count() %>%  #adding all observations for that year
  rename(Year = year, Count = n)

yearly_count_wide <- pivot_wider(yearly_count, names_from = Year, values_from = Count)


kable(yearly_count_wide, caption = "Table 1: Number of juvenlie snowshoe hares caught per year" , align = "c") %>% # making a finalized table with title
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F) # customizing table

# visualizing the data

ggplot(data = yearly_count, aes(x = Year, y = Count)) + # makign a column chart to display counts
  geom_col(color = "coral2", fill = "coral2") + # adding some color to the graph
  scale_x_continuous(limits=c(1997,2013), breaks = c(1998, 1999, 2000, 2001, 2002, 2003, 2004,2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012)) + #setting the x ais labels
  labs(caption = "Figure 1: Number of juvenile hares caught during sampling from 1998-2012, shown through bar chart with height representing number of individual hares.", title = "Hares caught each year (Babcock)") # adding a title and figure caption

# getting summary stats

invisible(summary(yearly_count))
```

Above, Figure 1 shows the number of hares caught each year of the survey period. The number of hares caught vaired between 38 and 410. The mean number of hares caught is 213, and the median is 179. The graph shows that the number of hares caught decreased in the years 2001 through 2005, but then the count rose to around the max value, and stayed there until the final count in 2012 where the number of hares decreased back to 2005 levels. Ensuring that both the number of traps, and days of of the year the traps are set are equal and consistent accross the survey's years can help reduce variance resulting from the studies methods. 

### Juvenile Hare Weights

```{r, layout="l-body-outset", fig.width = 10}

# making a datasets with relevant data

hare_weights <- hares_raw %>% # make a new data set with variables site sex and weight
  filter(age == "j") %>% # only include juvenile values 
  select(grid, sex, weight) %>% 
  rename("site" = grid) %>%  # rename site column 
  na.omit(hare_weights) # exclude values with NA

f_weight <- hare_weights %>% #making a vector of values for just female hare weights
  filter(sex == "f") %>% # selecting female values
  pull(weight) # pulling the data for weights

m_weight <- hare_weights %>% #making vectore of just male weights
  filter(sex =="m") %>% # selecting male values
  pull(weight) #pulling data for weights

# looking at the data

ggplot(data = hare_weights, aes(x = sex, y = weight)) + #exploratory scatter plot graph
  geom_jitter(aes(color = sex)) +
  facet_wrap(~ site) + # adding site as a face wrap for comparison
  labs(x = "Sex", y = "Weight (g)", title = "Plot of juvenile hare weight by sex faceted by site (Babcock)", caption = "Figure 2: This plot shows the distribution of hare weights for each sex, faceted by survey site, where *f* is female and *m* is male.")

ggplot(data = hare_weights, aes(x = weight)) + # exploratory histogram of weights
  geom_histogram(bins = 18, color = "coral2", fill = "coral2") + # setting bins at smaller value than default 30
  facet_wrap(~sex) + # separating based on sex to compare the two
  labs(x = "Weight (g)", y = "Percent of sample", title = "Histogram of juvenile hare weights by sex (Babcock)", caption = "Figure 3: This histogram shows the distribution of hare weights by percent of population, and is faceted by sex, where *f* is female and *m* is male.") + # adding labels
  theme_light()

# analyzing the data 

weights_t <- t.test(f_weight, m_weight) # t test comparing weights based on sex
weights_t # view results of t test


```

